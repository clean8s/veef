on: push

jobs:
  webpush:
    runs-on: ubuntu-latest
    steps:
    - name: Checkout
      uses: actions/checkout@v2
    - run: |
        mkdir /home/runner/web && git clone https://github.com/clean8s/foss.clean8s.com.git /home/runner/web/veef
        yarn
        yarn build
        mv -t /home/runner/web/veef dist/*
        cd /home/runner/web
        git config --local user.email "41898282+github-actions[bot]@users.noreply.github.com"
        git config --local user.name "github-actions[bot]"
        git add -A && git commit -m "[w-update]"
    - name: Push changes
      uses: ad-m/github-push-action@master
      with:
        github_token: ${{ secrets.GH_SECRET }}
        branch: main
